<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>$.js vs Include.js</title>
		<meta name="description" content="Demo: Include.js loading OpenId module" />
		<meta name="author" content="dan.s.ward" />
		<link rel="stylesheet" type="text/css" href="css/0x24.css" />
		<link rel="stylesheet" type="text/css" href="css/menu.css" />
	</head>
	<body style="background-color:#18946D;color:#eee;">
		<div id="content">
			<p style="text-align:center;">
				<button id="signin-link" class="button-link">Sign In</button>
				<button id="signout-link" class="button-link">Sign Out</button>
			</p>
			<hr />
			<h1>Include.js, LazyLoad.js, etc.</h1>
			<p>
				Include.js does not claim to manage dependencies. It is only being used here to
				demonstrate the difference between a barebones loader and one that manages dependencies.
				Include.js, LazyLoader.js and other barebones loaders just load the files you tell them to,
				requiring you to manage all of your	dependencies manually.
				This becomes a problem as soon as you have two or more modules that
				share one or more dependencies. As the added highlights show in the screen shot 
				below, most modules where loaded 2 - 3 times. Subsequent loads will most likely be
				taken from the cache, but the code in them will run every time a script tag is added
				for it which is likely to produce undesirable results at some point.
			</p>
			<img src="images/barebones.js.png" alt="fail" width="100%" />
		</div>
		<script type="text/javascript" src="/0x24/js/lib/include.js"></script>
		<script type="text/javascript">
			$ = {};
			$.path = '/0x24/js/lib/';
			$.require = function (modUrl, depSrcs, callback) { include(depSrcs, callback); };
			$.require('/0x24/Include.js.html',
			[
				$.path + '$.dom.js',
				$.path + '$.events.js',
				$.path + '$.openid-ui.js'
			],
			function() {
				var signinLink = document.getElementById("signin-link"),
					signoutLink = document.getElementById("signout-link"),
					openid;
				
				function signin() { $.events.publish('openid-signin-request', openid); }
				function signout() { $.events.publish('openid-signout-request', openid); }
				$.dom.addEventListener(signinLink, "click", signin);
				$.dom.addEventListener(signoutLink, "click", signout);
				
				function toggleSignIn(resp) {
					openid = resp;
					signinLink.style.display = (openid.userId.length ? 'none' : 'inline');
					signoutLink.style.display = (openid.userId.length ? 'inline' : 'none');
				}
				$.events.subscribe('openid-update-response', toggleSignIn);
				$.events.publish('openid-update-request', openid);
			});
		</script>
	</body>
</html>